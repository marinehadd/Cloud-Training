 - 

# Lab 1 : Create an environment

 Go to [https://aws.amazon.com/login](https://aws.amazon.com/free/) and choose the region

## Setup a VPC

 Go to VPC services then Your VPCs and create VPC
	- Click Create
	- Enter a name i.e. VPC-YourName
	- IPv4 CIDR : 10.0.0.0/16

You now have a VPC and an associated routing table created. Your VPC will need to be able to host instances accessible from both private environment and the Internet.

Go to Subnets and create a public and a private subnets.
- Subnet 1:
	- Name : YourName-Pub-Sub
	- Select your VPC
	- Select the first availability zone of your region (i.e. 1a)
	- IPv4 CIDR 10.0.1.0/24
- Subnet 2:
	- Name : YourName-Priv-Sub
	- Select your VPC
	- Select the second availability zone of your region (i.e. 1b)
	- IPv4 CIDR 10.0.2.0/24

Select Subnet 1, go to Actions and modify the auto-assign IP settings to allow the subnet to obtain public IP addresses dynamically.
In Routes Tables, select your VPC route table and notice the two subnets associated. They should find the ones you created above.

The public subnet needs access to the Internet which will be provided by an Internet Gateway.
Go to Internet Gateways and create one YourName-IGW. Then select it, Actions, and attach to your VPC.

Go back to your route table and notice that you have a new route 0.0.0.0/0 which is the association of your internet gateway. This means that both /24 subnets can now access the internet via this gateway.
However, only the public subnet (subnet 1) should be able to access the Internet so we will need to make a different route table for each type of access (public and private).

Create a route table:
- Name : YourName-Pub-RT
- VPC : Your VPC

Add an Internet Gateway:
- Edit routes then Add routes
- Destination 0.0.0.0/0
- Target : Internet Gateway and select your IGW
Save Routes

Associate the public subnet to the public route table:
- Edit subnet associations
- Select the public subnet
Save

## Setup a bastion

A bastion is a jump box that will allow you to connect to any private instance of your VPC from the Internet. It will act as an intermediate between the public and the private environments.

Go to EC2 Dashboard, launch an instance:
- AMI XXXXX
- Leave default Instance Type
- Instance details:
	- Network : your VPC
	- Subnet : your public subnet
	- Auto-assign public IP : YES
- Leave default storage
- Tag : Bastion-YourName
- Create a new Security Group
	- Name : Bastion-SG-YourName
	- Setup SSH and HTTP with source 0.0.0.0/0
- Review and Launch then Launch
- Create a new key pair EC2-KP-YourName and save your pem on your local drive

Download PuttyGen (and Putty if you haven't already):
[https://puttygen.com/download.php?val=49](https://puttygen.com/download.php?val=49)  (select manual download)


<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIxNDY4MTc4MDQsMjE5NDE1MDc3LC01NT
g5NTY3NTIsLTEwNDM4OTI4MDcsMTYyNzQ4NDI3NSwtMjczMDMy
NzgsMjEyNTkwOTM3LC02Njg1ODc2NjksMjA4ODI2NDgzMiwtMj
g4ODc5MjcsMjQwNjcyOTU4LC00OTA5MDQ2MTIsLTE4ODcxMDgz
MDIsMTM4Mzk5NzkwNCwtMjY2NDU0MjA2LC0xMjQyMjgyNjYyLC
03MjY2ODE4MDQsLTE2NzY5MDkxMjBdfQ==
-->